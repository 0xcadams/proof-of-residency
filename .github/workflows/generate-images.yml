name: generate-images

on:
  push:
    branches:
      - "main"
  # schedule:
  #   - cron: "*/5 * * * *"

defaults:
  run:
    working-directory: packages/generator

jobs:
  test:
    name: Generate New Images
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          ref: ${{ github.head_ref }}
          token: ${{ secrets.PAT }}
      - uses: actions/setup-node@v3
        with:
          node-version: 16
          cache: yarn
      - name: Install
        run: yarn --immutable
      - name: Install Playwright
        run: npx playwright install
      - name: Run screenshots
        run: yarn screenshots
      - uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "feat(generator): autogenerated new images"
